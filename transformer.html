<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Industrial Transformer Mastery - Beyond the Nameplate</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00d4ff; /* Main theme color - Electric Blue */
            --accent: #ffb700; /* Accent color - Gold/Yellow for warnings/emphasis */
            --success: #39ff14; /* Success/Good - Neon Green */
            --danger: #ff2e63; /* Danger/Bad - Neon Pink/Red */
            --dark-bg: #0a0e27; /* Deep Navy Blue */
            --card-bg: #1a2847; /* Slightly Lighter Navy */
            --text-main: #ffffff; /* White */
            --text-dim: #b0c4de; /* Light Steel Blue */
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        html, body {
            height: 100%;
            overflow: hidden; /* Prevent body scroll */
        }

        body {
            background: linear-gradient(135deg, var(--dark-bg) 0%, var(--card-bg) 50%, var(--dark-bg) 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Poppins', sans-serif;
            color: var(--text-main);
        }

        #container {
            width: 95vw;
            height: auto;
            max-width: 1600px;
            max-height: 95vh;
            aspect-ratio: 16/9;
            background: var(--dark-bg);
            border-radius: 30px;
            box-shadow: 0 0 80px rgba(0, 212, 255, 0.4), inset 0 0 40px rgba(0, 212, 255, 0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
            cursor: pointer;
        }

        .scene {
            width: 100%;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 2% 4%; /* Slightly reduced padding */
            text-align: center;
            opacity: 0;
            animation: fadeInScene 0.8s ease-out forwards;
            overflow-y: auto;
            position: relative;
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .scene::-webkit-scrollbar { display: none; }

        @keyframes fadeInScene { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUpIn { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } } /* Reduced Y */
        @keyframes slideDownIn { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } } /* Reduced Y */
        @keyframes scaleUpIn { from { opacity: 0; transform: scale(0.85); } to { opacity: 1; transform: scale(1); } } /* Adjusted scale */
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } } /* Adjusted scale */
        @keyframes glow { 0%, 100% { text-shadow: 0 0 15px rgba(0, 212, 255, 0.6), 0 0 30px rgba(0, 212, 255, 0.3); } 50% { text-shadow: 0 0 30px rgba(0, 212, 255, 1), 0 0 50px rgba(0, 212, 255, 0.5); } } /* Adjusted glow */

        .title {
            font-size: clamp(1.8rem, 4.5vw, 3.2rem); /* Adjusted */
            font-weight: 800;
            margin-bottom: 0.8rem;
            line-height: 1.1;
            animation: slideDownIn 0.8s ease-out;
            letter-spacing: 0.5px;
        }

        .subtitle {
            font-size: clamp(1.4rem, 3.5vw, 2.3rem); /* Adjusted */
            font-weight: 700;
            margin-bottom: 0.8rem;
            line-height: 1.15;
            animation: slideUpIn 0.8s ease-out 0.1s forwards;
            opacity: 0;
        }

        .punchy-headline {
            font-size: clamp(1.2rem, 3vw, 2rem); /* Adjusted */
            font-weight: 700; /* Slightly reduced weight */
            margin: 0.6rem 0;
            line-height: 1.25;
            animation: slideUpIn 0.8s ease-out 0.15s forwards;
            opacity: 0;
            letter-spacing: 0.3px;
        }

        .content-text {
            font-size: clamp(0.9rem, 2.2vw, 1.4rem); /* Adjusted */
            color: var(--text-dim);
            line-height: 1.65; /* Adjusted */
            margin: 0.6rem auto;
            animation: slideUpIn 0.9s ease-out 0.2s forwards;
            max-width: 92%; /* Increased max-width slightly */
            opacity: 0;
        }

        .text-primary { color: var(--primary); animation: glow 2.5s infinite; font-weight: 700; }
        .text-accent { color: var(--accent); font-weight: 700; }
        .text-success { color: var(--success); font-weight: 700; }
        .text-danger { color: var(--danger); font-weight: 700; }
        .text-white { color: white; }

        .icon-large {
            font-size: clamp(3rem, 7vw, 5rem); /* Adjusted */
            animation: pulse 2.2s infinite;
            margin: 0.8rem 0;
        }

        .card {
            background: rgba(0, 212, 255, 0.08);
            border: 2px solid var(--primary);
            border-radius: 16px; /* Adjusted */
            padding: 1.2rem; /* Adjusted */
            margin: 0.6rem auto;
            animation: scaleUpIn 0.7s ease-out; /* Faster animation */
            width: 96%; /* Increased width */
            max-width: 850px; /* Adjusted max-width */
            text-align: left;
            backdrop-filter: blur(8px); /* Reduced blur */
            -webkit-backdrop-filter: blur(8px);
        }

        .card.accent { background: rgba(255, 183, 0, 0.08); border-color: var(--accent); } /* Yellow */
        .card.success { background: rgba(57, 255, 20, 0.08); border-color: var(--success); } /* Green */
        .card.danger { background: rgba(255, 46, 99, 0.08); border-color: var(--danger); } /* Red/Pink */

        .card-title {
            font-size: clamp(1rem, 2.5vw, 1.5rem); /* Adjusted */
            font-weight: 700;
            margin-bottom: 0.6rem;
            letter-spacing: 0.3px;
        }

        .card-text {
            font-size: clamp(0.85rem, 1.8vw, 1.2rem); /* Adjusted */
            color: #e0e8f0;
            line-height: 1.7; /* Adjusted */
        }

        .card-text strong { color: var(--success); font-weight: 700; }
        .card-text .highlight { color: var(--primary); font-weight: 700; }
        .card-text .critical { color: var(--danger); font-weight: 700; }

        .code-text {
            font-family: 'Courier New', monospace;
            background: rgba(0,0,0,0.35); /* Slightly darker */
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            font-size: clamp(0.8rem, 1.6vw, 1.1rem); /* Relative size */
            display: inline-block; /* Prevent stretching */
            margin: 0.2rem 0;
        }

        .formula-font {
            font-family: 'Courier New', monospace;
            line-height: 1.7;
            font-size: clamp(0.85rem, 1.9vw, 1.2rem); /* Adjusted */
        }
        
        .formula-box {
            background: rgba(0, 0, 0, 0.45); /* Darker */
            border-left: 4px solid var(--accent); /* Changed border color */
            padding: 1rem;
            margin: 0.8rem auto;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: clamp(0.9rem, 2vw, 1.3rem);
            line-height: 1.7;
            text-align: center;
            animation: slideUpIn 0.9s ease-out;
            width: fit-content; /* Fit content */
            max-width: 90%;
        }


        .two-col-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); /* Adjusted */
            gap: 0.8rem;
            width: 98%;
            max-width: 1200px; /* Adjusted */
            margin: 0.8rem auto;
            animation: slideUpIn 1s ease-out; /* Faster */
        }

        .three-col-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); /* Adjusted */
            gap: 0.7rem;
            width: 98%;
            max-width: 1200px; /* Adjusted */
            margin: 0.8rem auto;
            animation: slideUpIn 1s ease-out; /* Faster */
        }

        .comparison-table {
            width: 95%;
            max-width: 950px; /* Adjusted */
            margin: 1rem auto;
            border-collapse: collapse;
            animation: scaleUpIn 0.8s ease-out; /* Faster */
        }

        .comparison-table th, .comparison-table td {
            padding: 0.7rem; /* Adjusted */
            text-align: left;
            border-bottom: 1px solid rgba(0, 212, 255, 0.3); /* Thinner border */
            font-size: clamp(0.8rem, 1.7vw, 1rem); /* Adjusted */
            color: var(--text-dim);
        }

        .comparison-table th {
            background: rgba(0, 212, 255, 0.15);
            font-weight: 700;
            color: var(--primary);
        }

        .comparison-table tr td:first-child {
            color: var(--text-main);
            font-weight: 600;
        }

        .comparison-table tr:hover {
            background: rgba(0, 212, 255, 0.08);
        }

        .checklist-item {
            display: flex;
            align-items: flex-start;
            margin: 0.7rem 0;
            color: var(--text-dim);
            line-height: 1.5; /* Adjusted */
            font-size: clamp(0.85rem, 1.9vw, 1.1rem); /* Adjusted */
            animation: slideUpIn 1s ease-out; /* Faster */
            text-align: left;
        }

        .checklist-item strong { color: var(--success); font-weight: 700; }
        .check-icon {
            color: var(--success);
            font-weight: 900;
            margin-right: 0.7rem;
            font-size: 1.1em; /* Adjusted */
            line-height: 1.1;
        }

        .key-point {
            background: linear-gradient(90deg, rgba(255, 183, 0, 0.2) 0%, rgba(255, 46, 99, 0.1) 100%); /* Yellow to Red */
            border-left: 4px solid var(--accent);
            padding: 0.9rem; /* Adjusted */
            margin: 0.8rem auto;
            border-radius: 8px;
            font-size: clamp(0.9rem, 2.2vw, 1.2rem); /* Adjusted */
            line-height: 1.6;
            animation: slideUpIn 0.8s ease-out; /* Faster */
            text-align: left;
        }

        .footer-wrapper {
            width: 100%;
            text-align: center;
            padding: 8px 0 10px 0; /* Adjusted padding */
            background: var(--dark-bg);
            font-size: clamp(0.8rem, 1.5vw, 1rem);
            color: rgba(176, 196, 222, 0.8);
            flex-shrink: 0;
            animation: slideUpIn 1.2s ease-out; /* Faster */
            position: relative;
            z-index: 10;
        }
        .footer-line {
            border: 0;
            height: 1px;
            background: rgba(0, 212, 255, 0.3);
            width: 80%;
            margin: 0 auto 6px auto; /* Adjusted margin */
        }
        .footer-wrapper a {
           color: var(--primary);
           text-decoration: none;
           font-weight: 600;
        }
        .footer-wrapper a:hover {
            text-decoration: underline;
        }

    </style>
</head>
<body>

<div id="container"></div>

<script>
    const container = document.getElementById('container');
    let currentSceneIndex = 0;
    let sceneInterval;

    // --- UPDATED SCENE CONFIG WITH EXAMPLE CALCULATION ---
    const sceneConfig = [
        // SCENE 1: Title Card (8s)
        { id: 1, duration: 8000, content: `
            <div class="title text-primary">‚ö° INDUSTRIAL TRANSFORMER MASTERY ‚ö°</div>
            <div class="subtitle text-success">Powering Industry: Beyond the Nameplate</div>
            <div class="punchy-headline text-accent">Unlock the Secrets OEMs Don't Teach You</div>
            <div class="icon-large">üîå</div>`
        },
        // SCENE 2: The Crisis (7s)
        { id: 2, duration: 7000, content: `
            <div class="title text-danger">üî¥ The Silent Giant's Costly Failure</div>
            <div class="punchy-headline text-accent">$5M fire. Weeks of outage. One wrong spec.</div>
            <div class="content-text text-white">Transformers are reliable... until they're not. Failure is catastrophic.</div>
            <div class="key-point">
                A steel mill ignored harmonic loading (K-Factor) on a new 2500 kVA dry-type transformer. Result: Overheating, insulation failure, and fire within 18 months.
            </div>`
        },
        // SCENE 3: Why This Video (6s)
        { id: 3, duration: 6000, content: `
            <div class="title text-success">Why This Masterclass is CRITICAL</div>
            <div class="punchy-headline text-primary">Nameplate Ratings are Just the STARTING Point.</div>
            <div class="content-text">This isn't about reading specs. It's about understanding the physics, the environment, and the hidden risks to ensure 30+ years of reliable power.</div>`
        },
        // SCENE 4: The 6 Core Pillars (9s)
        { id: 4, duration: 9000, content: `
            <div class="title text-primary">The 6 Pillars of Transformer Expertise</div>
            <div class="punchy-headline text-accent">Your Foundation for Flawless Specification.</div>
            <div class="content-text" style="font-size: clamp(1rem, 2.8vw, 1.6rem); line-height: 1.8; text-align: left; display: inline-block;">
                1Ô∏è‚É£ Core Ratings & Construction (kVA, Volts, Phase, Type)<br>
                2Ô∏è‚É£ Impedance (%Z) & Short Circuit Duty<br>
                3Ô∏è‚É£ Cooling Class & Environmental Impact (Temp Rise, ONAN/ONAF)<br>
                4Ô∏è‚É£ Harmonic Loading (K-Factor) & Non-Linear Loads<br>
                5Ô∏è‚É£ Efficiency & Loss Evaluation (DOE Standards, TCO)<br>
                6Ô∏è‚É£ Protection & Safety (BIL, Overcurrent, Grounding)
            </div>`
        },

        // --- PILLAR 1 ---
        // SCENE 5: Core Ratings (10s)
        { id: 5, duration: 10000, content: `
            <div class="title text-primary">PILLAR #1: Decoding the Nameplate Basics</div>
            <div class="punchy-headline text-success">kVA, Voltage, Phase: The Fundamentals</div>
            <div class="card success">
                <div class="card-title text-success">Key Ratings:</div>
                <div class="card-text">
                    <strong>kVA (Apparent Power):</strong> Total power capacity. Drives physical size.<br>
                    <strong>Primary/Secondary Voltage:</strong> Defines transformation ratio.<br>
                    <strong>Phase (1√ò or 3√ò):</strong> Determines application.<br>
                    <strong>Frequency (Hz):</strong> Must match grid (50/60Hz).
                </div>
            </div>`
        },
        // SCENE 6: Construction Types (11s)
        { id: 6, duration: 11000, content: `
            <div class="subtitle text-primary">Construction: Oil vs. Dry Type</div>
            <div class="punchy-headline text-accent">Choosing the Right Medium for Your Application</div>
             <div class="two-col-grid">
                <div class="card">
                    <div class="card-title text-primary">Oil-Filled (Pad/Substation)</div>
                    <div class="card-text">
                        <strong>Pros:</strong> Superior cooling, higher BIL, lower cost/kVA.<br>
                        <strong>Cons:</strong> Fire risk, outdoor/vault use, environmental concerns.
                    </div>
                </div>
                <div class="card accent">
                    <div class="card-title text-accent">Dry-Type (VPI/Cast Coil)</div>
                    <div class="card-text">
                        <strong>Pros:</strong> Fire resistant (indoor use), lower maintenance.<br>
                        <strong>Cons:</strong> Lower BIL, larger/heavier per kVA, sensitive to environment.
                    </div>
                </div>
            </div>`
        },

        // --- PILLAR 2 ---
        // SCENE 7: Impedance (12s)
        { id: 7, duration: 12000, content: `
            <div class="title text-accent">PILLAR #2: Impedance (%Z) - The Gatekeeper</div>
            <div class="punchy-headline text-danger">The MOST Misunderstood & Critical Spec!</div>
            <div class="card accent">
                <div class="card-title text-accent">What is Impedance (%Z)?</div>
                <div class="card-text">
                    Voltage drop at full load (%). Higher %Z = Lower Fault Current, Higher Voltage Drop.<br>
                    Lower %Z = Higher Fault Current, Lower Voltage Drop.
                </div>
                 <div class="card-title text-accent" style="margin-top: 1rem;">Why it Matters:</div>
                 <div class="card-text">
                    Determines <span class="critical">Short Circuit Current (SCCR)</span>. Affects breaker ratings & voltage regulation. Crucial for paralleling.
                 </div>
            </div>`
        },
        // SCENE 8: Short Circuit Duty (10s)
        { id: 8, duration: 10000, content: `
            <div class="subtitle text-danger">Short Circuit Current Calculation</div>
            <div class="punchy-headline text-accent">How %Z Controls System Destruction</div>
             <div class="formula-box text-white">
                Fault Amps = FLA / (%Z / 100)
             </div>
             <div class="card danger">
                 <div class="card-title text-danger">Example: 1000 kVA, 480V, 5.75%Z</div>
                 <div class="card-text">
                    FLA = 1203A<br>
                    Fault Current = 1203A / 0.0575 = <span class="critical">20,920 Amps!</span><br>
                    <span class="text-white" style="font-weight: 700;">Downstream gear AIC must be > 21kA.</span>
                 </div>
             </div>`
        },

        // --- PILLAR 3 ---
        // SCENE 9: Cooling Class (11s)
        { id: 9, duration: 11000, content: `
            <div class="title text-primary">PILLAR #3: Cooling & Temperature Rise</div>
            <div class="punchy-headline text-success">Keeping the Giant Cool Under Pressure</div>
            <div class="card success">
                <div class="card-title text-success">Cooling Classes (IEC/IEEE):</div>
                <div class="card-text">
                    <strong>Oil:</strong> ONAN (Natural), ONAF (Forced Fans)<br>
                    <strong>Dry:</strong> AN (Natural), AF (Forced Fans)<br>
                    ONAF/AF adds <span class="highlight">~15-33% extra kVA capacity</span>.
                </div>
                <div class="card-title text-success" style="margin-top: 1rem;">Temperature Rise:</div>
                <div class="card-text">
                    Max winding temp rise above ambient (e.g., 65¬∞C oil, 150¬∞C dry). Lower rise = longer life.
                </div>
            </div>`
        },
        // SCENE 10: Environmental Impact (9s)
        { id: 10, duration: 9000, content: `
            <div class="subtitle text-accent">Environmental Realities</div>
            <div class="punchy-headline text-danger">Heat, Altitude, & Dirt: The Transformer Killers</div>
            <div class="card accent">
                <div class="card-title text-accent">De-Rating Factors:</div>
                <div class="card-text">
                    <strong>Altitude:</strong> Reduce kVA ~0.3-0.5% per 100m above 1000m.<br>
                    <strong>Ambient Temp:</strong> Reduce kVA ~1-1.5% per ¬∞C above rated ambient.<br>
                    <strong>Dirt/Dust (Dry Type):</strong> Clogs ducts ‚Üí overheating. Clean regularly!
                </div>
            </div>`
        },

        // --- PILLAR 4 ---
        // SCENE 11: Harmonics Intro (10s)
        { id: 11, duration: 10000, content: `
            <div class="title text-danger">PILLAR #4: Harmonics - The Invisible Threat</div>
            <div class="punchy-headline text-accent">VFDs, LEDs, Computers are Killing Your Transformer!</div>
            <div class="card danger">
                <div class="card-title text-danger">What Are Harmonics?</div>
                <div class="card-text">
                   Non-linear loads create <span class="critical">extra frequencies</span> that cause additional heating in windings and core. Standard transformers aren't designed for this!
                </div>
            </div>`
        },
        // SCENE 12: K-Factor (12s)
        { id: 12, duration: 12000, content: `
            <div class="subtitle text-danger">K-Factor Rated Transformers</div>
            <div class="punchy-headline text-accent">Designed to Survive Harmonic Hell</div>
            <div class="card danger">
                <div class="card-title text-danger">What is K-Factor?</div>
                <div class="card-text">
                    Ability to handle harmonic heating.<br>
                    <strong>K-1:</strong> Standard loads.<br>
                    <strong>K-4:</strong> PCs, UPS.<br>
                    <strong>K-13:</strong> Multiple PCs, Welders.<br>
                    <strong>K-20/K-30:</strong> VFDs, Data Centers.
                </div>
                 <div class="key-point" style="border-left-color: var(--danger);">
                    Using a K-1 transformer on a K-13 load = Guaranteed overheating. MUST specify correct K-Factor.
                 </div>
            </div>`
        },

        // --- PILLAR 5 ---
        // SCENE 13: Efficiency (11s)
        { id: 13, duration: 11000, content: `
            <div class="title text-success">PILLAR #5: Efficiency & Total Cost</div>
            <div class="punchy-headline text-primary">Beyond Purchase Price: The Real Cost Over 30 Years</div>
            <div class="card success">
                <div class="card-title text-success">DOE Efficiency Standards:</div>
                <div class="card-text">
                    Mandate minimum efficiency. Higher efficiency = lower operating cost.
                </div>
                <div class="card-title text-success" style="margin-top: 1rem;">Total Cost of Ownership (TCO):</div>
                <div class="card-text">
                    TCO = Purchase Price + (Cost of Losses √ó Lifespan)<br>
                    A <span class="highlight">lower loss</span> transformer often has a lower TCO.
                </div>
            </div>`
        },
        // SCENE 14: Loss Evaluation (10s)
        { id: 14, duration: 10000, content: `
            <div class="subtitle text-success">Evaluating Losses: A vs. B Factors</div>
            <div class="punchy-headline text-primary">Quantifying the $ Value of Wasted Energy</div>
             <div class="formula-box text-white">
                Loss Cost = (A √ó No-Load kW) + (B √ó Load kW)
             </div>
             <div class="card success">
                 <div class="card-title text-success">A/B Factors ($/kW):</div>
                 <div class="card-text">
                    Represent capitalized cost of losses. Use to compare bids & select lowest TCO.
                 </div>
             </div>`
        },

        // --- PILLAR 6 ---
        // SCENE 15: Protection - BIL (10s)
        { id: 15, duration: 10000, content: `
            <div class="title text-accent">PILLAR #6: Protection & Safety - BIL</div>
            <div class="punchy-headline text-danger">Lightning & Surges: Your Transformer's Shield</div>
            <div class="card accent">
                <div class="card-title text-accent">BIL (Basic Impulse Level):</div>
                <div class="card-text">
                    Ability to withstand voltage surges (kV). Higher system voltage = Higher required BIL.<br>
                    <span class="critical">Under-specifying BIL = Catastrophic failure during a surge.</span>
                </div>
            </div>`
        },
        // SCENE 16: Protection - Overcurrent & Grounding (11s)
        { id: 16, duration: 11000, content: `
            <div class="subtitle text-danger">Overcurrent & Grounding Protection</div>
            <div class="punchy-headline text-accent">Code Requirements are NON-NEGOTIABLE</div>
             <div class="two-col-grid">
                <div class="card danger">
                    <div class="card-title text-danger">Overcurrent Protection</div>
                    <div class="card-text">
                        <strong>Primary:</strong> Protects transformer (NEC 450).<br>
                        <strong>Secondary:</strong> Protects feeders. Coordination is key!
                    </div>
                </div>
                <div class="card accent">
                    <div class="card-title text-accent">Grounding (Critical!)</div>
                    <div class="card-text">
                        <strong>System:</strong> Secondary neutral bonded (creates SDS).<br>
                        <strong>Equipment:</strong> Case bonded to grid.<br>
                        <span class="critical">Improper grounding = Hazard!</span>
                    </div>
                </div>
            </div>`
        },

        // --- NEW: EXAMPLE CALCULATION START ---
        // SCENE 17: Case Study Intro (12s)
        { id: 17, duration: 12000, content: `
            <div class="title text-success">Real-World Sizing Example</div>
            <div class="punchy-headline text-primary">Let's Apply the 6 Pillars: New Production Line</div>
            <div class="card success">
                <div class="card-title text-success">Scenario:</div>
                <div class="card-text">
                    Feed a new indoor manufacturing area.<br>
                    <strong>Primary Supply:</strong> 13.8 kV, 3√ò<br>
                    <strong>Required Secondary:</strong> 480/277V, 3√ò, 4-Wire<br>
                    <strong>Location:</strong> Denver, CO (Altitude ~1600m)<br>
                    <strong>Environment:</strong> Indoor, climate-controlled, max ambient 35¬∞C<br>
                    <strong>Loads:</strong> Mix of VFDs, CNC machines, lighting, PLCs.
                </div>
            </div>`
        },
        // SCENE 18: Step 1 - Load Calculation (15s)
        { id: 18, duration: 15000, content: `
            <div class="subtitle text-success">Example Step 1: Calculate Total Load kVA</div>
            <div class="punchy-headline text-primary">Sum Loads + Diversity + Future Growth</div>
            <div class="card">
                <div class="card-title text-primary">Load Summary (Connected):</div>
                <div class="card-text formula-font">
                    - VFD Motors: 350 kVA<br>
                    - CNC Machines: 200 kVA<br>
                    - Lighting (LED): 50 kVA<br>
                    - Controls/PLC: 25 kVA<br>
                    - HVAC: 75 kVA<br>
                    <strong>Total Connected = 700 kVA</strong>
                </div>
                 <div class="card-title text-primary" style="margin-top: 1rem;">Apply Factors:</div>
                 <div class="card-text formula-font">
                    - Demand Factor (Diversity): 0.85 (Not all loads run simultaneously)<br>
                    - Future Growth: 1.20 (Allow 20% spare capacity)<br><br>
                    Calculated Demand = 700 kVA * 0.85 = 595 kVA<br>
                    Required kVA = 595 kVA * 1.20 = <span class="highlight">714 kVA</span>
                 </div>
                 <div class="card-text" style="margin-top:0.5rem"><strong>Decision: Select next standard size up ‚Üí <span class="text-success">750 kVA</span></strong></div>
            </div>`
        },
        // SCENE 19: Step 2 - Type & Ratings (12s)
        { id: 19, duration: 12000, content: `
            <div class="subtitle text-success">Example Step 2: Basic Ratings & Type</div>
            <div class="punchy-headline text-primary">Matching Voltages and Choosing Construction</div>
            <div class="card success">
                <div class="card-title text-success">Core Specification:</div>
                <div class="card-text">
                    <strong>kVA:</strong> 750 kVA (from Step 1)<br>
                    <strong>Primary Voltage:</strong> 13800V Delta<br>
                    <strong>Secondary Voltage:</strong> 480Y/277V Wye (for L-N loads)<br>
                    <strong>Phase:</strong> 3-Phase<br>
                    <strong>Frequency:</strong> 60 Hz
                </div>
                 <div class="card-title text-success" style="margin-top: 1rem;">Construction Type:</div>
                 <div class="card-text">
                    Indoor location, need fire resistance.<br>
                    <strong>Decision: <span class="highlight">Dry-Type (VPI or Cast Coil)</span></strong>
                 </div>
            </div>`
        },
        // SCENE 20: Step 3 - Environment & De-rating (14s)
        { id: 20, duration: 14000, content: `
            <div class="subtitle text-accent">Example Step 3: Environment & De-rating</div>
            <div class="punchy-headline text-warning">Does our 750 kVA need upsizing?</div>
            <div class="card accent">
                <div class="card-title text-accent">Check Conditions:</div>
                <div class="card-text">
                    <strong>Altitude:</strong> 1600m (Denver)<br>
                    <strong>Ambient Temp:</strong> Max 35¬∞C
                </div>
                <div class="card-title text-accent" style="margin-top: 1rem;">Calculate De-rating:</div>
                <div class="card-text formula-font">
                   <strong>Altitude De-rate (Dry):</strong><br>
                   (1600m - 1000m) * (0.3% / 100m) = 600m * 0.00003 = 0.018 = <span class="critical">1.8%</span><br><br>
                   <strong>Temperature De-rate:</strong><br>
                   Standard Dry rating based on 40¬∞C ambient.<br>
                   Our max ambient is 35¬∞C (< 40¬∞C).<br>
                   <span class="highlight">No temperature de-rating needed.</span> <br>(If ambient was 45¬∞C, de-rate = (45-40)*1.5% = 7.5%)
                </div>
                 <div class="card-text" style="margin-top:0.5rem">
                    Total De-rate = 1.8%. Effective Capacity = 750 kVA * (1 - 0.018) = 736.5 kVA.<br>
                    Required was 714 kVA. <strong>Decision: <span class="text-success">750 kVA is still adequate.</span></strong>
                 </div>
            </div>`
        },
        // SCENE 21: Step 4 - Harmonics (K-Factor) (14s)
        { id: 21, duration: 14000, content: `
            <div class="subtitle text-danger">Example Step 4: Harmonic Loading (K-Factor)</div>
            <div class="punchy-headline text-accent">Assess the Non-Linear Loads</div>
            <div class="card danger">
                <div class="card-title text-danger">Load Analysis:</div>
                <div class="card-text">
                    Significant portion of load is VFDs and CNC machines (switch-mode power supplies). LED lighting also contributes.<br>
                    This indicates substantial harmonic currents.
                </div>
                <div class="card-title text-danger" style="margin-top: 1rem;">K-Factor Selection:</div>
                <div class="card-text">
                    Based on load mix (VFDs dominant non-linear source):<br>
                    K-4: Too low.<br>
                    K-13: Might be sufficient if VFDs have line reactors.<br>
                    K-20: Safer choice given the high proportion of non-linear load.<br><br>
                    <strong>Decision: Specify <span class="highlight">K-Factor = K-13 minimum, recommend K-20.</span></strong><br>
                    (Note: K-rated transformers may need slight kVA oversizing per manufacturer guidance). Let's assume K-13 requires no oversizing here.
                </div>
            </div>`
        },
         // SCENE 22: Step 5 - Impedance (13s)
        { id: 22, duration: 13000, content: `
            <div class="subtitle text-accent">Example Step 5: Impedance (%Z)</div>
            <div class="punchy-headline text-primary">Balancing Fault Current & Voltage Drop</div>
            <div class="card accent">
                <div class="card-title text-accent">Selection:</div>
                <div class="card-text">
                    Standard impedance for 750 kVA Dry Type is often <span class="highlight">5.75%Z</span>.
                </div>
                <div class="card-title text-accent" style="margin-top: 1rem;">Calculations:</div>
                <div class="card-text formula-font">
                    FLA (750 kVA @ 480V) = 750 / (0.48 * ‚àö3) = 902A<br>
                    Fault Current = 902A / 0.0575 = <span class="critical">15,687A</span><br>
                    Voltage Drop @ Full Load ‚âà 5.75% (Acceptable for most industrial uses).
                </div>
                 <div class="card-text" style="margin-top:0.5rem">
                    <strong>Decision: <span class="highlight">Specify 5.75%Z.</span> Verify downstream panelboard AIC ratings are >= 16kA (e.g., 22kA or higher).</strong>
                 </div>
            </div>`
        },
        // SCENE 23: Step 6 - Cooling & Temp Rise (12s)
        { id: 23, duration: 12000, content: `
            <div class="subtitle text-success">Example Step 6: Cooling & Temp Rise</div>
            <div class="punchy-headline text-primary">Standard Choices for Dry Type</div>
            <div class="card success">
                <div class="card-title text-success">Cooling Class:</div>
                <div class="card-text">
                    Standard for Dry Type: <span class="highlight">AN (Air Natural)</span>.<br>
                    Optional: Add AF (Air Forced) fans for extra capacity (~33%). We sized for AN, so fans provide overload capability.
                </div>
                <div class="card-title text-success" style="margin-top: 1rem;">Temperature Rise:</div>
                <div class="card-text">
                    Standard for modern Dry Type: <span class="highlight">150¬∞C Rise</span> (over 40¬∞C ambient, using 220¬∞C insulation system).<br>
                    Options: 115¬∞C or 80¬∞C rise available for longer life/overload, but higher cost.
                </div>
                 <div class="card-text" style="margin-top:0.5rem">
                    <strong>Decision: Specify <span class="highlight">AA / FA (AN/AF) Cooling, 150¬∞C Temperature Rise</span>.</strong> Include fan package & controls.
                 </div>
            </div>`
        },
         // SCENE 24: Step 7 - Efficiency & Protection (13s)
        { id: 24, duration: 13000, content: `
            <div class="subtitle text-primary">Example Step 7: Efficiency & Protection</div>
            <div class="punchy-headline text-success">Final Checks for Longevity & Safety</div>
            <div class="two-col-grid">
                <div class="card success">
                    <div class="card-title text-success">Efficiency</div>
                    <div class="card-text">
                        Specify compliance with latest <span class="highlight">DOE 2016 standards</span> minimum.<br>
                        Consider requesting bids with evaluated losses (A/B factors) if lowest TCO is critical.
                    </div>
                </div>
                <div class="card accent">
                    <div class="card-title text-accent">Protection</div>
                    <div class="card-text">
                        <strong>BIL:</strong> Standard for 15kV class Dry Type is typically <span class="highlight">95kV BIL</span>. Verify this is adequate for system surge protection coordination.<br>
                        <strong>Overcurrent:</strong> Size primary fuse/breaker per NEC 450 (e.g., 125%-250% of Pri FLA). Coordinate with secondary protection.
                    </div>
                </div>
            </div>`
        },
         // SCENE 25: Final Specification Summary (14s)
        { id: 25, duration: 14000, content: `
            <div class="title text-success">Example: Final Transformer Specification</div>
            <div class="punchy-headline text-primary">Bringing It All Together</div>
            <div class="card success">
                <div class="card-title text-success">Summary Specification:</div>
                <div class="card-text formula-font">
                    <strong>Type:</strong> Dry Type, Ventilated (VPI or Cast Coil)<br>
                    <strong>kVA Rating:</strong> 750 kVA AA / 1000 kVA FA (with Fans)<br>
                    <strong>Primary Volts:</strong> 13800V Delta, 95kV BIL<br>
                    <strong>Secondary Volts:</strong> 480Y/277V Wye<br>
                    <strong>Phase / Freq:</strong> 3-Phase / 60 Hz<br>
                    <strong>Impedance:</strong> 5.75 %Z (+/- 7.5% tolerance)<br>
                    <strong>Temperature Rise:</strong> 150¬∞C (over 40¬∞C ambient)<br>
                    <strong>K-Factor:</strong> K-13 (Minimum, K-20 Recommended)<br>
                    <strong>Efficiency:</strong> Meet or exceed DOE 2016<br>
                    <strong>Enclosure:</strong> NEMA 1 (Indoor)<br>
                    <strong>Accessories:</strong> Fan Package with Controller, Standard Taps
                </div>
                 <div class="card-text" style="margin-top:0.5rem">
                    This detailed spec, derived from load analysis and environmental factors, ensures a safe and reliable installation.
                 </div>
            </div>`
        },
        // --- EXAMPLE CALCULATION END ---

        // --- INSTALLATION (Original Scene 17 becomes 26) ---
        // SCENE 26: Installation Clearances (10s)
        { id: 26, duration: 10000, content: `
            <div class="title text-primary">Installation: Giving it Space to Breathe</div>
            <div class="punchy-headline text-accent">Clearances are NOT optional.</div>
            <div class="card primary">
                <div class="card-title text-primary">Minimum Clearances (NEC/Manufacturer):</div>
                <div class="card-text">
                    Allow airflow for cooling and safe access.<br>
                    <strong>Dry Type (Indoors):</strong> Check specs (e.g., 6" sides, 12" top/bottom). Keep away from combustibles.<br>
                    <strong>Oil Filled (Outdoors):</strong> Maintain clearances per NEC Art. 450 & local codes. Requires containment.
                </div>
            </div>`
        },
        // SCENE 27: Installation Connections (11s)
        { id: 27, duration: 11000, content: `
            <div class="subtitle text-success">Installation: Making Solid Connections</div>
            <div class="punchy-headline text-primary">Torque Matters. Phasing Matters.</div>
            <div class="card success">
                <div class="card-title text-success">Connection Best Practices:</div>
                <div class="card-text">
                    <strong>Torque Specs:</strong> Use a torque wrench! Loose connections = overheating = failure.<br>
                    <strong>Correct Phasing:</strong> Verify A-B-C rotation. Incorrect = equipment damage.<br>
                    <strong>Cable Support:</strong> Use proper strain relief.<br>
                    <strong>Grounding Bond:</strong> Ensure solid case-to-grid connection.
                </div>
            </div>`
        },

        // --- TESTING & COMMISSIONING (Original Scene 19 becomes 28) ---
        // SCENE 28: Testing Overview (10s)
        { id: 28, duration: 10000, content: `
            <div class="title text-accent">Testing & Commissioning: Verify Before Energizing</div>
            <div class="punchy-headline text-danger">"Trust, but Verify." Don't Skip These Tests!</div>
            <div class="card accent">
                <div class="card-title text-accent">Why Test?</div>
                <div class="card-text">
                   Confirm no shipping damage. Verify nameplate data. Establish baseline. Ensure safety!
                </div>
            </div>`
        },
        // SCENE 29: Key Electrical Tests (12s)
        { id: 29, duration: 12000, content: `
            <div class="subtitle text-accent">Key Pre-Energization Electrical Tests</div>
            <div class="punchy-headline text-primary">Megger, TTR, Winding Resistance</div>
             <div class="three-col-grid">
                <div class="card">
                    <div class="card-title text-primary">Insulation Resistance (Megger)</div>
                    <div class="card-text">Checks insulation integrity (HV-LV, HV-GND, LV-GND).</div>
                </div>
                <div class="card">
                    <div class="card-title text-primary">Turns Ratio (TTR)</div>
                    <div class="card-text">Verifies voltage ratio matches nameplate (< 0.5% diff).</div>
                </div>
                <div class="card">
                    <div class="card-title text-primary">Winding Resistance</div>
                    <div class="card-text">Checks for connection issues or damage (low mŒ©, balanced).</div>
                </div>
            </div>`
        },
        // SCENE 30: Oil Tests (DGA) (10s)
        { id: 30, duration: 10000, content: `
            <div class="subtitle text-accent">Oil Tests (For Oil-Filled Units)</div>
            <div class="punchy-headline text-primary">The Transformer's "Blood Test"</div>
            <div class="card accent">
                <div class="card-title text-accent">Dissolved Gas Analysis (DGA):</div>
                <div class="card-text">
                    <span class="highlight">The single most important oil test.</span> Detects internal faults (arcing, overheating) by analyzing gases. Baseline essential.
                </div>
                 <div class="card-title text-accent" style="margin-top: 1rem;">Other Oil Tests:</div>
                 <div class="card-text">Dielectric Strength, Moisture, Acidity.</div>
            </div>`
        },

        // --- MAINTENANCE (Original Scene 22 becomes 31) ---
        // SCENE 31: Maintenance Strategy (11s)
        { id: 31, duration: 11000, content: `
            <div class="title text-success">Maintenance: Protecting Your 30-Year Asset</div>
            <div class="punchy-headline text-primary">Proactive Care Prevents Catastrophic Failure</div>
            <div class="card success">
                <div class="card-title text-success">Key Maintenance Activities:</div>
                <div class="card-text">
                    <strong>Routine Inspections:</strong> Visual checks, Thermography.<br>
                    <strong>Oil Sampling (Annually - Oil):</strong> DGA.<br>
                    <strong>Electrical Testing (3-5 Years):</strong> Megger, TTR, Winding Res.<br>
                    <strong>Cleaning (Annually - Dry):</strong> Vacuum ducts.
                </div>
            </div>`
        },

        // --- FAILURES (Original Scene 23 becomes 32) ---
        // SCENE 32: Common Failure Modes (12s)
        { id: 32, duration: 12000, content: `
            <div class="title text-danger">Common Transformer Failure Modes</div>
            <div class="punchy-headline text-accent">Why Do These Giants Fail?</div>
             <div class="three-col-grid">
                <div class="card danger">
                    <div class="card-title text-danger">Insulation Breakdown</div>
                    <div class="card-text">Cause: Overheating (harmonics!), moisture, surges, aging.</div>
                </div>
                <div class="card danger">
                    <div class="card-title text-danger">Bushing Failure</div>
                    <div class="card-text">Cause: Cracks, contamination, loose connections.</div>
                </div>
                <div class="card danger">
                    <div class="card-title text-danger">Tap Changer Failure</div>
                    <div class="card-text">Cause: Mechanical wear, contact coking (OLTC).</div>
                </div>
            </div>`
        },

        // --- SUMMARY (Original Scene 24 becomes 33) ---
        // SCENE 33: Expert Checklist (13s)
        { id: 33, duration: 13000, content: `
            <div class="title text-success">Your Expert Transformer Specification Checklist</div>
            <div class="punchy-headline text-accent">Nail the Spec, Guarantee Reliability.</div>
            <div class="card success" style="max-width: 1000px; font-size: clamp(0.9rem, 2.1vw, 1.2rem);">
                <div class="checklist-item"><span class="check-icon">‚ñ°</span><div><strong>Ratings:</strong> Confirm kVA, Volts, Phase, Cooling match load.</div></div>
                <div class="checklist-item"><span class="check-icon">‚ñ°</span><div><strong>Impedance (%Z):</strong> Verify fault duty & voltage drop.</div></div>
                <div class="checklist-item"><span class="check-icon">‚ñ°</span><div><strong>Environment:</strong> Apply de-rating (Altitude/Temp).</div></div>
                <div class="checklist-item"><span class="check-icon">‚ñ°</span><div><strong>Harmonics:</strong> Specify correct K-Factor.</div></div>
                <div class="checklist-item"><span class="check-icon">‚ñ°</span><div><strong>Efficiency:</strong> Evaluate losses & TCO.</div></div>
                <div class="checklist-item"><span class="check-icon">‚ñ°</span><div><strong>Protection:</strong> Ensure adequate BIL & Overcurrent.</div></div>
                <div class="checklist-item"><span class="check-icon">‚ñ°</span><div><strong>Type:</strong> Choose Oil vs. Dry.</div></div>
            </div>`
        },
        // SCENE 34: Final Thoughts (10s)
        { id: 34, duration: 10000, content: `
            <div class="title text-success">Mastering Transformers: The Payoff</div>
            <div class="punchy-headline text-primary">This knowledge prevents disasters & saves millions.</div>
            <div class="content-text" style="font-size: clamp(1.2rem, 3vw, 1.7rem); line-height: 1.8;">
                You now understand the critical factors beyond the nameplate.<br><br>
                Specifying correctly ensures safety, reliability, and protects your facility's most vital asset.
            </div>`
        },
        // SCENE 35: Call to Action (10s)
        { id: 35, duration: 10000, content: `
            <div class="title text-success">Thank You For Watching This Masterclass</div>
            <div class="subtitle text-primary">Visit Our Resource Hub</div>
            <div class="subtitle text-accent" style="animation: pulse 2s infinite; font-size: clamp(1.2rem, 3.5vw, 2rem); margin-top: 1rem;">
                 <a href="https://designcalculators.co.in" target="_blank" style="color: var(--accent); text-decoration: none;">https://designcalculators.co.in</a>
            </div>
            <div class="content-text" style="margin-top: 2rem; color: var(--text-dim);">
                Free transformer calculators, technical articles, and standards guides.
            </div>`
        },
        // SCENE 36: Closing Frame (8s)
        { id: 36, duration: 8000, content: `
            <div class="title text-primary" style="animation: glow 2s infinite;">‚ö° Industrial Transformer Mastery ‚ö°</div>
            <div class="subtitle text-success">Beyond the Nameplate</div>
            <div class="content-text" style="font-size: clamp(1rem, 2.5vw, 1.5rem); margin-top: 2rem; color: var(--text-dim);">
                Specify with insight. Install with precision. Maintain with confidence.
            </div>
            <div class="icon-large" style="margin-top: 1.5rem; animation: pulse 1.5s infinite;">üí°</div>`
        }
    ]; // Total scenes = 36

    // --- JAVASCRIPT LOGIC (Unchanged from previous version) ---

    function showScene(index) {
        container.innerHTML = '';

        if (sceneConfig[index]) {
            const sceneData = sceneConfig[index];

            const sceneElement = document.createElement('div');
            sceneElement.id = `scene${sceneData.id}`;
            sceneElement.className = 'scene';
            sceneElement.innerHTML = sceneData.content;
            container.appendChild(sceneElement);

            const footerEl = document.createElement('div');
            footerEl.className = 'footer-wrapper';
            footerEl.innerHTML = `
                <hr class="footer-line">
                <div>prepared by <a href="https://designcalculators.co.in" target="_blank">https://designcalculators.co.in</a></div>
            `;
            container.appendChild(footerEl);

            requestAnimationFrame(() => {
                sceneElement.scrollTop = 0;
            });
        } else {
            console.error(`Invalid scene index: ${index}`);
            currentSceneIndex = 0;
            showScene(0);
        }
    }

    function nextScene() {
        currentSceneIndex = (currentSceneIndex + 1) % sceneConfig.length;
        showScene(currentSceneIndex);
        resetInterval();
    }

    function prevScene() {
        currentSceneIndex = (currentSceneIndex - 1 + sceneConfig.length) % sceneConfig.length;
        showScene(currentSceneIndex);
        resetInterval();
    }

    function resetInterval() {
        clearInterval(sceneInterval);

        let duration = 9000; // Increased default duration slightly for calculations
        if (sceneConfig[currentSceneIndex] && typeof sceneConfig[currentSceneIndex].duration === 'number') {
            duration = sceneConfig[currentSceneIndex].duration;
        }

        sceneInterval = setInterval(nextScene, duration);
    }

    // Initial setup
    if (sceneConfig.length > 0) {
        showScene(0);
        resetInterval();
    }

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowRight' || e.key === ' ') {
            e.preventDefault();
            nextScene();
        } else if (e.key === 'ArrowLeft') {
            e.preventDefault();
            prevScene();
        }
    });

    // Mouse click to advance
    container.addEventListener('click', (e) => {
        if (e.target.tagName === 'A' || e.target.closest('a')) {
            return;
        }
        nextScene();
    });

    // --- Touch Navigation ---
    let touchStartX = 0;
    let touchEndX = 0;
    let touchStartY = 0;
    let touchEndY = 0;
    const swipeThreshold = 50;
    const tapThreshold = 10;
    let touchStartTime = 0;
    const tapTimeThreshold = 200;

    container.addEventListener('touchstart', (e) => {
        let target = e.target;
        while (target && target !== container) {
            if (target.classList.contains('scene') && target.scrollHeight > target.clientHeight) {
                return; // Allow vertical scroll within scene
            }
            target = target.parentNode;
        }
        touchStartX = e.changedTouches[0].screenX;
        touchStartY = e.changedTouches[0].screenY;
        touchStartTime = new Date().getTime();
    }, { passive: true });


    container.addEventListener('touchend', (e) => {
        if (e.target.tagName === 'A' || e.target.closest('a')) {
            return;
        }
        if (touchStartX === 0) { // Touch started on scrollable content
           touchStartY = 0;
           touchStartTime = 0;
           return;
        }

        touchEndX = e.changedTouches[0].screenX;
        touchEndY = e.changedTouches[0].screenY;
        const touchTime = new Date().getTime() - touchStartTime;
        const diffX = touchEndX - touchStartX;
        const diffY = touchEndY - touchStartY;
        const absDiffX = Math.abs(diffX);
        const absDiffY = Math.abs(diffY);

        // Reset start points
        touchStartX = 0;
        touchStartY = 0;
        touchStartTime = 0;

        if (absDiffX < tapThreshold && absDiffY < tapThreshold && touchTime < tapTimeThreshold) {
            return; // It was a tap, let click handler manage
        }

        if (absDiffX > swipeThreshold && absDiffX > absDiffY) {
            e.stopPropagation(); // Prevent click
            if (diffX < 0) { // Swipe Left
                nextScene();
            } else { // Swipe Right
                prevScene();
            }
        }
    });

</script>

</body>
</html>
