<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Industrial Cable Sizing - The Definitive Guide</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Architects+Daughter&family=Kalam:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --board-bg: #f8f9fa;
            --draw-color: #1a1a1a;
            --primary-blue: #0056b3;
            --danger-red: #b33600;
            --success-green: #28a745;
            --warning-orange: #b36b00;
            --info-purple: #5e35b1;
            --font-main: 'Kalam', cursive;
            --font-alt: 'Architects Daughter', cursive;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            font-family: var(--font-main);
        }

        #whiteboard-container {
            position: relative;
            background: #000;
            width: 100vw; 
            height: 56.25vw;
            max-height: 100vh;
            max-width: 177.78vh;
            margin: auto;
            box-shadow: 0 0 40px rgba(255, 255, 255, 0.1);
        }

        #whiteboard {
            width: 100%;
            height: 100%;
            background-color: var(--board-bg);
            position: relative;
            overflow: hidden;
        }

        #animation-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .anim-element {
            opacity: 0;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
        
        #splash-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #2c3e50;
            z-index: 100;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #fff;
            transition: opacity 1s ease-out;
        }

        #splash-screen.fade-out {
            opacity: 0;
            pointer-events: none;
        }
        
        #splash-screen h1 {
            font-family: var(--font-main);
            font-size: 5vw;
            margin-bottom: 20px;
            font-weight: 700;
        }
        
        #splash-screen p {
             font-family: var(--font-alt);
             font-size: 2.5vw;
        }

        #replay-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 200;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.5s;
            pointer-events: none;
        }
        #replay-container.visible {
            opacity: 1;
            pointer-events: auto;
        }
        
        #replay-btn {
            font-family: sans-serif;
            font-weight: bold;
            font-size: 2vw;
            padding: 20px 40px;
            cursor: pointer;
            border: 3px solid var(--primary-blue);
            background-color: #fff;
            color: var(--primary-blue);
            border-radius: 8px;
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        #replay-btn:hover {
             background-color: var(--primary-blue); 
             color: #fff;
             transform: scale(1.05);
        }

        #progress-bar-container {
            position: absolute;
            bottom: 0px;
            left: 0;
            right: 0;
            height: 5px;
            background: rgba(0, 0, 0, 0.1);
        }

        #progress-bar {
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, #28a745, #20c997);
            transition: width 0.3s ease;
        }

        .fade-in { animation: fadeIn 0.5s ease-in forwards; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>
    <div id="whiteboard-container">
        <div id="splash-screen">
            <h1>Industrial Cable Sizing</h1>
            <p>The Definitive Professional Guide</p>
        </div>
        <div id="whiteboard">
            <svg id="animation-svg" viewBox="0 0 1600 900"></svg>
            <div id="progress-bar-container">
                <div id="progress-bar"></div>
            </div>
        </div>
        <div id="replay-container">
            <button id="replay-btn">Replay Tutorial</button>
        </div>
    </div>

<script>
    const svgNS = "http://www.w3.org/2000/svg";
    const svg = document.getElementById('animation-svg');
    const progressBar = document.getElementById('progress-bar');
    const splashScreen = document.getElementById('splash-screen');
    const replayContainer = document.getElementById('replay-container');
    const replayBtn = document.getElementById('replay-btn');
    
    let activeElements = [];
    let animationFrame;
    let timeouts = [];
    let isPlaying = false;

    const TOTAL_DURATION = 230; // seconds, increased for clarity

    const timeline = [
        // SECTION 1: TITLE (0-15s)
        { time: 0.5, type: 'text', id: 'title1', text: 'The Ultimate Guide to', x: 800, y: 320, fontSize: 110, anchor: 'middle', weight: 'bold', duration: 3 },
        { time: 4, type: 'text', id: 'title2', text: 'INDUSTRIAL CABLE SIZING', x: 800, y: 480, fontSize: 130, anchor: 'middle', weight: 'bold', fill: 'var(--primary-blue)', duration: 4 },
        { time: 9, type: 'text', id: 'subtitle', text: 'Beyond the Formula: The Professional Method', x: 800, y: 590, fontSize: 70, anchor: 'middle', duration: 4 },
        { time: 13, type: 'path', id: 'title-underline', d: 'M 150 620 H 1450', stroke: 'var(--primary-blue)', strokeWidth: 8, duration: 2 },
        { time: 16, type: 'clear'},
        
        // SECTION 2: THE 3 PILLARS (17-45s)
        { time: 17, type: 'text', id: 'pillars-title', text: 'The 3 Pillars of Cable Sizing', x: 800, y: 120, fontSize: 100, weight: 'bold', anchor: 'middle', duration: 3 },
        { time: 21, type: 'rect', id: 'box1', x: 100, y: 190, width: 1400, height: 160, stroke: 'var(--draw-color)', strokeWidth: 5, fill: 'rgba(0,0,0,0.02)', duration: 1},
        { time: 22, type: 'text', id: 'pillar1', text: '1. Ampacity (Current Capacity) Check', x: 800, y: 295, fontSize: 72, weight: 'bold', fill: 'var(--danger-red)', anchor: 'middle', duration: 5 },
        { time: 28, type: 'rect', id: 'box2', x: 100, y: 370, width: 1400, height: 160, stroke: 'var(--draw-color)', strokeWidth: 5, fill: 'rgba(0,0,0,0.02)', duration: 1},
        { time: 29, type: 'text', id: 'pillar2', text: '2. Voltage Drop Check', x: 800, y: 475, fontSize: 72, weight: 'bold', fill: 'var(--warning-orange)', anchor: 'middle', duration: 4 },
        { time: 34, type: 'rect', id: 'box3', x: 100, y: 550, width: 1400, height: 160, stroke: 'var(--draw-color)', strokeWidth: 5, fill: 'rgba(0,0,0,0.02)', duration: 1},
        { time: 35, type: 'text', id: 'pillar3', text: '3. Short Circuit Withstand Check', x: 800, y: 655, fontSize: 72, weight: 'bold', fill: 'var(--info-purple)', anchor: 'middle', duration: 5 },
        { time: 42, type: 'text', id: 'iec-std', text: 'Based on International Standard IEC 60364', x: 800, y: 820, fontSize: 60, anchor: 'middle', duration: 3},
        { time: 46, type: 'clear' },

        // SECTION 3: EXAMPLE SETUP (47-75s)
        { time: 47, type: 'text', id: 'example-title', text: 'Example: Feeder for a 55kW Motor', x: 800, y: 100, fontSize: 90, weight: 'bold', anchor: 'middle', fill: 'var(--success-green)', duration: 3 },
        { time: 51, type: 'text', id: 'given-title', text: 'Project Data:', x: 100, y: 220, fontSize: 70, weight: 'bold', duration: 2},
        { time: 54, type: 'text', id: 'given1', text: '• Motor: 55kW, 400V, 3-Ph, PF=0.85, Eff=92%', x: 150, y: 320, fontSize: 62, duration: 4 },
        { time: 59, type: 'text', id: 'given2', text: '• Cable Length: 120 meters (0.12 km)', x: 150, y: 410, fontSize: 62, duration: 3 },
        { time: 63, type: 'text', id: 'given3', text: '• Installation: 3 cables on a ladder tray', x: 150, y: 500, fontSize: 62, duration: 3 },
        { time: 67, type: 'text', id: 'given4', text: '• Ambient Temperature: 45°C', x: 150, y: 590, fontSize: 62, duration: 3 },
        { time: 71, type: 'text', id: 'given5', text: '• System Fault Level: 25kA for 1 second', x: 150, y: 680, fontSize: 62, duration: 3 },
        { time: 76, type: 'clear' },
        
        // SECTION 4: AMPACITY CHECK (77-123s)
        { time: 77, type: 'text', id: 'step1-title-main', text: 'Step 1: Ampacity Check', x: 800, y: 100, fontSize: 90, weight: 'bold', fill: 'var(--danger-red)', anchor: 'middle', duration: 3 },
        { time: 81, type: 'text', id: 'flc-title', text: 'Full Load Current (I_L):', x: 100, y: 200, fontSize: 68, duration: 2},
        { time: 84, type: 'text', id: 'flc-calc', text: 'I_L = 55000 / (1.732 × 400 × 0.85 × 0.92)', x: 150, y: 290, fontSize: 62, duration: 5},
        { time: 90, type: 'text', id: 'flc-result', text: 'I_L = 101.8 Amperes', x: 800, y: 380, fontSize: 72, anchor: 'middle', weight: 'bold', fill: 'var(--draw-color)', duration: 3 },
        { time: 94, type: 'path', d: 'M 50 440 H 1550', stroke: 'rgba(0,0,0,0.2)', strokeWidth: 3, duration: 1 },
        { time: 96, type: 'text', id: 'derating-title', text: 'Derating Factors (K):', x: 100, y: 520, fontSize: 68, duration: 2 },
        { time: 99, type: 'text', id: 'k1', text: ' • Temp (K_temp) = 0.91 | Grouping (K_group) = 0.88', x: 150, y: 610, fontSize: 62, fill: 'var(--warning-orange)', duration: 6 },
        { time: 106, type: 'text', id: 'k-total-calc', text: 'K_total = 0.91 × 0.88 = 0.80', x: 800, y: 700, fontSize: 72, anchor: 'middle', weight: 'bold', duration: 4 },
        { time: 111, type: 'text', id: 'req-iz-title', text: 'Required Cable Rating (I_z) = I_L / K_total', x: 800, y: 780, fontSize: 64, anchor: 'middle', duration: 4 },
        { time: 116, type: 'text', id: 'req-iz-result', text: 'I_z ≥ 127.25 Amperes', x: 800, y: 860, fontSize: 78, anchor: 'middle', weight: 'bold', fill: 'var(--danger-red)', duration: 4 },
        { time: 122, type: 'clear' },

        // SECTION 5: CABLE SELECTION & VD CHECK (123-170s)
        { time: 123, type: 'text', id: 'selection-title', text: 'Cable Selection (from IEC Tables)', x: 800, y: 100, fontSize: 84, anchor: 'middle', weight: 'bold', fill: 'var(--success-green)', duration: 3 },
        { time: 127, type: 'text', id: 'selection-text', text: 'Based on Iz ≥ 127.25A, we select a 35mm² Copper cable.', x: 800, y: 200, fontSize: 64, anchor: 'middle', duration: 4 },
        { time: 132, type: 'text', id: 'selection-rating', text: '(Standard rating is ~140A)', x: 800, y: 270, fontSize: 50, anchor: 'middle', fill: '#555', duration: 3 },
        { time: 136, type: 'path', d: 'M 50 330 H 1550', stroke: 'rgba(0,0,0,0.2)', strokeWidth: 3, duration: 1 },
        { time: 138, type: 'text', id: 'step2-title-main', text: 'Step 2: Voltage Drop Check', x: 800, y: 410, fontSize: 90, weight: 'bold', fill: 'var(--warning-orange)', anchor: 'middle', duration: 3 },
        { time: 142, type: 'text', id: 'rx-data', text: 'For 35mm² cable: R=0.64 Ω/km, X=0.08 Ω/km', x: 800, y: 500, fontSize: 62, anchor: 'middle', duration: 4 },
        { time: 147, type: 'text', id: 'vd-formula', text: 'VD = 1.732 × I_L × L × [R·cos(φ) + X·sin(φ)]', x: 800, y: 590, fontSize: 60, anchor: 'middle', duration: 4 },
        { time: 152, type: 'text', id: 'vd-calc', text: 'VD = 1.732 × 101.8 × 0.12 × [0.64×0.85 + 0.08×0.527]', x: 800, y: 670, fontSize: 54, anchor: 'middle', duration: 6 },
        { time: 159, type: 'text', id: 'vd-result', text: 'VD = 12.38 Volts', x: 800, y: 750, fontSize: 72, anchor: 'middle', weight: 'bold', duration: 3 },
        { time: 163, type: 'text', id: 'vd-percent', text: '%VD = (12.38V / 400V) × 100 = 3.1%', x: 800, y: 830, fontSize: 68, anchor: 'middle', weight: 'bold', duration: 4 },
        { time: 168, type: 'text', id: 'vd-pass', text: 'PASS ✓ (Acceptable < 5%)', x: 800, y: 890, fontSize: 64, anchor: 'middle', weight: 'bold', fill: 'var(--success-green)', duration: 3 },
        { time: 173, type: 'clear' },
        
        // SECTION 6: SHORT CIRCUIT CHECK & CONCLUSION (174-230s)
        { time: 174, type: 'text', id: 'step3-title-main', text: 'Step 3: Short Circuit Check', x: 800, y: 120, fontSize: 90, weight: 'bold', fill: 'var(--info-purple)', anchor: 'middle', duration: 3 },
        { time: 178, type: 'text', id: 'sc-formula', text: 'Min. Area (S) = ( I_sc × √t ) / k', x: 800, y: 240, fontSize: 72, anchor: 'middle', duration: 5 },
        { time: 184, type: 'text', id: 'k-factor', text: 'k = 143 for Copper/XLPE insulation', x: 800, y: 320, fontSize: 58, anchor: 'middle', fill: '#555', duration: 4 },
        { time: 189, type: 'text', id: 'sc-calc', text: 'S = ( 25000 A × √1s ) / 143', x: 800, y: 420, fontSize: 68, anchor: 'middle', duration: 6 },
        { time: 196, type: 'text', id: 'sc-result', text: 'S (min) = 174.8 mm²', x: 800, y: 530, fontSize: 78, anchor: 'middle', weight: 'bold', fill: 'var(--danger-red)', duration: 4 },
        { time: 201, type: 'text', id: 'sc-fail', text: 'FAIL! Our 35mm² cable is TOO SMALL for the fault!', x: 800, y: 630, fontSize: 68, anchor: 'middle', weight: 'bold', fill: 'var(--danger-red)', duration: 5 },
        { time: 207, type: 'rect', id: 'final-box', x: 100, y: 690, width: 1400, height: 160, stroke: 'var(--success-green)', strokeWidth: 8, fill: 'rgba(40, 167, 69, 0.1)', duration: 1},
        { time: 209, type: 'text', id: 'final-selection', text: 'CORRECT SELECTION: 185mm² Cable', x: 800, y: 790, fontSize: 80, anchor: 'middle', weight: 'bold', fill: 'var(--success-green)', duration: 5 },
        { time: 215, type: 'text', id: 'final-summary', text: 'The cable must be upsized to safely handle the short circuit.', x: 800, y: 880, fontSize: 54, anchor: 'middle', duration: 4 },
        { time: 220, type: 'text', id: 'footer-link', text: 'For more tools, visit: https://designcalculators.co.in', x: 800, y: 850, fontSize: 50, anchor: 'middle', weight: 'bold', fill: 'var(--primary-blue)', duration: 5},
    ];

    function resetAnimation() {
        isPlaying = false;
        timeouts.forEach(t => clearTimeout(t));
        timeouts = [];
        if (animationFrame) cancelAnimationFrame(animationFrame);
        while(svg.firstChild) svg.removeChild(svg.firstChild);
        activeElements = [];
        progressBar.style.width = '0%';
    }

    function updateUI(elapsedSeconds) {
        const percentage = (elapsedSeconds / TOTAL_DURATION) * 100;
        progressBar.style.width = percentage + '%';
    }

    function createElement(item) {
        let el;
        if (item.type === 'text') {
            el = document.createElementNS(svgNS, 'text');
            el.setAttribute('x', item.x);
            el.setAttribute('y', item.y);
            el.setAttribute('font-size', item.fontSize);
            el.setAttribute('fill', item.fill || 'var(--draw-color)');
            if (item.anchor) el.setAttribute('text-anchor', item.anchor);
            if (item.weight) el.setAttribute('font-weight', item.weight);
            el.textContent = '';
            el.setAttribute('data-text', item.text);
        } else if (item.type === 'path' || item.type === 'rect') {
            el = document.createElementNS(svgNS, item.type);
            if (item.type === 'path') {
                el.setAttribute('d', item.d);
            } else { // rect
                el.setAttribute('x', item.x);
                el.setAttribute('y', item.y);
                el.setAttribute('width', item.width);
                el.setAttribute('height', item.height);
                el.setAttribute('rx', 15);
            }
            el.setAttribute('stroke', item.stroke || 'var(--draw-color)');
            el.setAttribute('stroke-width', item.strokeWidth || 4);
            el.setAttribute('fill', item.fill || 'none');
        }
        if (el) {
            el.id = item.id;
            el.classList.add('anim-element');
            svg.appendChild(el);
        }
        return el;
    }

    function typeText(el, text, duration) {
        if (!text || text.length === 0) { el.style.opacity = 1; return; }
        let charIndex = 0;
        const chars = text.split('');
        const actualDelay = Math.max(40, (duration * 1000) / chars.length);
        el.style.opacity = 1;

        function addNextChar() {
            if (charIndex < chars.length && isPlaying) {
                el.textContent += chars[charIndex++];
                timeouts.push(setTimeout(addNextChar, actualDelay));
            }
        }
        addNextChar();
    }

    function drawShape(el, duration) {
        el.style.opacity = 1;
        el.style.animationDuration = (duration > 1 ? 1 : duration) + 's';
        el.classList.add('fade-in');
    }

    function animateItem(item) {
        if (item.type === 'clear') {
            activeElements.forEach(el => el && el.parentNode && svg.removeChild(el));
            activeElements = [];
            return;
        }
        const el = createElement(item);
        if(!el) return;
        activeElements.push(el);
        if(item.type === 'text') {
            typeText(el, el.getAttribute('data-text'), item.duration);
        } else {
            drawShape(el, item.duration);
        }
    }

    function startAnimation() {
        if(isPlaying) return;
        
        resetAnimation();
        replayContainer.classList.remove('visible');
        isPlaying = true;
        const startTime = Date.now();

        timeline.forEach(item => {
            const timeout = setTimeout(() => {
                if(isPlaying) animateItem(item);
            }, item.time * 1000);
            timeouts.push(timeout);
        });

        function updateProgress() {
            if(!isPlaying) return;
            const elapsed = (Date.now() - startTime) / 1000;
            
            if(elapsed >= TOTAL_DURATION) {
                isPlaying = false;
                progressBar.style.width = '100%';
                // Hide the footer link at the very end before showing replay
                const footer = document.getElementById('footer-link');
                if(footer) footer.style.opacity = 0;

                setTimeout(() => replayContainer.classList.add('visible'), 2000);
                return;
            }
            
            updateUI(elapsed);
            animationFrame = requestAnimationFrame(updateProgress);
        }
        updateProgress();
    }

    function initTutorial() {
        setTimeout(() => {
            splashScreen.classList.add('fade-out');
            setTimeout(() => {
                splashScreen.style.display = 'none';
                startAnimation();
            }, 1000);
        }, 3000);
    }

    replayBtn.addEventListener('click', () => {
        // Ensure footer is hidden before replay
        const footer = document.getElementById('footer-link');
        if(footer) footer.style.opacity = 0;
        startAnimation();
    });
    window.addEventListener('load', initTutorial);
    window.addEventListener('beforeunload', resetAnimation);
</script>
</body>
</html>


