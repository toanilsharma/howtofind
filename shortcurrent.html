<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Short-Circuit Analysis - The Definitive Masterclass</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Architects+Daughter&family=Kalam:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --board-bg: #f8f9fa;
            --draw-color: #1a1a1a;
            --primary-blue: #0056b3;
            --danger-red: #d32f2f;
            --success-green: #28a745;
            --warning-orange: #f57c00;
            --info-purple: #5e35b1;
            --font-main: 'Kalam', cursive;
            --font-alt: 'Architects Daughter', cursive;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            font-family: var(--font-main);
        }

        #whiteboard-container {
            position: relative;
            background: #000;
            width: 100vw; 
            height: 56.25vw;
            max-height: 100vh;
            max-width: 177.78vh;
            margin: auto;
            box-shadow: 0 0 40px rgba(255, 255, 255, 0.1);
        }

        #whiteboard {
            width: 100%;
            height: 100%;
            background-color: var(--board-bg);
            position: relative;
            overflow: hidden;
        }

        #animation-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .anim-element {
            opacity: 0;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
        
        #splash-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #1a2a3a;
            z-index: 100;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #fff;
            transition: opacity 1s ease-out;
        }

        #splash-screen.fade-out { opacity: 0; pointer-events: none; }
        #splash-screen h1 { font-family: var(--font-main); font-size: 5vw; margin-bottom: 20px; font-weight: 700; }
        #splash-screen p { font-family: var(--font-alt); font-size: 2.5vw; }

        #replay-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 200;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.5s;
            pointer-events: none;
        }
        #replay-container.visible { opacity: 1; pointer-events: auto; }
        
        #replay-btn {
            font-family: sans-serif;
            font-weight: bold;
            font-size: 2vw;
            padding: 20px 40px;
            cursor: pointer;
            border: 3px solid var(--primary-blue);
            background-color: #fff;
            color: var(--primary-blue);
            border-radius: 8px;
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        #replay-btn:hover { background-color: var(--primary-blue); color: #fff; transform: scale(1.05); }

        #progress-bar-container {
            position: absolute;
            bottom: 0px;
            left: 0;
            right: 0;
            height: 5px;
            background: rgba(0, 0, 0, 0.1);
        }

        #progress-bar {
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, var(--danger-red), var(--warning-orange));
            transition: width 0.2s ease;
        }

        .fade-in { animation: fadeIn 0.4s ease-in forwards; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .flash { animation: flashAnim 0.5s infinite; }
        @keyframes flashAnim { 
            0%, 100% { fill: var(--danger-red); }
            50% { fill: var(--warning-orange); }
        }
    </style>
</head>
<body>
    <div id="whiteboard-container">
        <div id="splash-screen">
            <h1>Short-Circuit Analysis</h1>
            <p>The Definitive Masterclass</p>
        </div>
        <div id="whiteboard">
            <svg id="animation-svg" viewBox="0 0 1600 900"></svg>
            <div id="progress-bar-container">
                <div id="progress-bar"></div>
            </div>
        </div>
        <div id="replay-container">
            <button id="replay-btn">Replay Masterclass</button>
        </div>
    </div>

<script>
    const svgNS = "http://www.w3.org/2000/svg";
    const svg = document.getElementById('animation-svg');
    const progressBar = document.getElementById('progress-bar');
    const splashScreen = document.getElementById('splash-screen');
    const replayContainer = document.getElementById('replay-container');
    const replayBtn = document.getElementById('replay-btn');
    
    let activeElements = [];
    let animationFrame;
    let timeouts = [];
    let isPlaying = false;

    const TOTAL_DURATION = 205; 

    const timeline = [
        // SECTION 1: The 5 Ws - WHAT
        { time: 1, type: 'text', id: 'title-what', text: 'WHAT is a Short Circuit?', x: 800, y: 150, fontSize: 120, anchor: 'middle', weight: 'bold', duration: 3, fill: 'var(--danger-red)' },
        { time: 4.5, type: 'text', id: 'what-desc', text: "A violent, low-impedance path...", x: 800, y: 280, fontSize: 72, anchor: 'middle', duration: 2.5},
        { time: 7, type: 'text', id: 'what-desc1b', text: "...causing thousands of amps to flow instantly.", x: 800, y: 360, fontSize: 72, anchor: 'middle', duration: 3},
        { time: 10.5, type: 'text', id: 'what-desc2', text: "The 'Fault Level' (kA) is the max current", x: 800, y: 480, fontSize: 72, anchor: 'middle', duration: 3},
        { time: 13.5, type: 'text', id: 'what-desc2b', text: "that can flow at a specific point.", x: 800, y: 560, fontSize: 72, anchor: 'middle', duration: 3},
        { time: 17, type: 'rect', id: 'what-box', x: 100, y: 660, width: 1400, height: 180, stroke: 'var(--draw-color)', strokeWidth: 8, fill: 'none', duration: 2},
        { time: 19.5, type: 'text', id: 'what-analogy', text: 'Think: a dam bursting, not a river flowing.', x: 800, y: 760, fontSize: 80, anchor: 'middle', weight: 'bold', duration: 4},
        { time: 24, type: 'clear' },
        
        // SECTION 2: The 5 Ws - WHY
        { time: 25, type: 'text', id: 'title-why', text: 'WHY is this the #1 Study?', x: 800, y: 150, fontSize: 120, anchor: 'middle', weight: 'bold', duration: 3, fill: 'var(--primary-blue)' },
        { time: 28.5, type: 'text', id: 'why-1', text: '1. SELECT Equipment:', x: 150, y: 320, fontSize: 72, weight: 'bold', duration: 2.5},
        { time: 31, type: 'text', id: 'why-1-sub', text: 'Breakers MUST have a kA rating > Fault Level.', x: 250, y: 410, fontSize: 60, duration: 4},
        { time: 35.5, type: 'text', id: 'why-2', text: '2. PREVENT Catastrophe:', x: 150, y: 560, fontSize: 72, weight: 'bold', duration: 3},
        { time: 38.5, type: 'text', id: 'why-2-sub', text: 'Under-rated gear can EXPLODE (Arc Flash).', x: 250, y: 650, fontSize: 60, duration: 4, fill: 'var(--danger-red)'},
        { time: 43, type: 'text', id: 'why-3', text: '3. PROTECT the System:', x: 150, y: 800, fontSize: 72, weight: 'bold', duration: 3},
        { time: 46.5, type: 'clear' },
        
        // SECTION 3: The 5 Ws - WHO, WHEN, WHERE
        { time: 47.5, type: 'text', id: 'title-www', text: 'WHO, WHEN & WHERE?', x: 800, y: 150, fontSize: 120, anchor: 'middle', weight: 'bold', duration: 3, fill: 'var(--info-purple)' },
        { time: 51, type: 'text', id: 'who', text: 'WHO: A qualified Power System Engineer.', x: 800, y: 320, fontSize: 72, anchor: 'middle', duration: 3},
        { time: 54.5, type: 'text', id: 'when', text: 'WHEN: During the design phase.', x: 800, y: 470, fontSize: 72, anchor: 'middle', duration: 3, fill: 'var(--success-green)'},
        { time: 57.5, type: 'text', id: 'when-sub', text: 'Before anything is built!', x: 800, y: 550, fontSize: 72, anchor: 'middle', duration: 2.5, fill: 'var(--success-green)'},
        { time: 60.5, type: 'text', id: 'where', text: 'WHERE: At all critical nodes', x: 800, y: 700, fontSize: 72, anchor: 'middle', duration: 3},
        { time: 63.5, type: 'text', id: 'where-sub', text: '(Busbars, Switchgear, MCCs).', x: 800, y: 780, fontSize: 72, anchor: 'middle', duration: 3},
        { time: 67, type: 'clear' },

        // SECTION 4: The BIG Difference: AC vs DC
        { time: 68, type: 'text', id: 'title-acdc', text: 'The BIG Difference: AC vs. DC Faults', x: 800, y: 120, fontSize: 110, anchor: 'middle', weight: 'bold', duration: 3 },
        { time: 71.5, type: 'text', id: 'ac-title', text: 'AC Faults', x: 400, y: 250, fontSize: 80, anchor: 'middle', weight: 'bold', fill: 'var(--primary-blue)'},
        { time: 72.5, type: 'path', id: 'ac-wave', d: 'M100,450 q 75 -150 150 0 t 150 0 t 150 0 t 150 0', stroke: 'var(--primary-blue)', strokeWidth: 8, fill: 'none', duration: 3 },
        { time: 73, type: 'path', id: 'ac-axis', d: 'M50,450 H 750', stroke: 'var(--draw-color)', strokeWidth: 3, fill: 'none', duration: 1},
        { time: 76, type: 'text', id: 'ac-desc', text: 'Current passes through ZERO.', x: 400, y: 580, fontSize: 64, anchor: 'middle', duration: 3 },
        { time: 79, type: 'text', id: 'ac-desc2', text: 'This helps breakers extinguish the arc.', x: 400, y: 680, fontSize: 64, anchor: 'middle', duration: 4, fill: 'var(--success-green)'},
        { time: 83.5, type: 'path', id: 'divider', d: 'M800,200 V 800', stroke: 'rgba(0,0,0,0.3)', strokeWidth: 4, duration: 1},
        { time: 84, type: 'text', id: 'dc-title', text: 'DC Faults', x: 1200, y: 250, fontSize: 80, anchor: 'middle', weight: 'bold', fill: 'var(--danger-red)'},
        { time: 85, type: 'path', id: 'dc-wave', d: 'M900,600 C 1000 600, 1100 350, 1500 350', stroke: 'var(--danger-red)', strokeWidth: 8, fill: 'none', duration: 2.5 },
        { time: 85.5, type: 'path', id: 'dc-axis', d: 'M850,600 H 1550', stroke: 'var(--draw-color)', strokeWidth: 3, fill: 'none', duration: 1},
        { time: 88, type: 'text', id: 'dc-desc', text: 'NO zero crossing!', x: 1200, y: 580, fontSize: 64, anchor: 'middle', duration: 3, weight: 'bold' },
        { time: 91, type: 'text', id: 'dc-desc2', text: 'Current rises and stays high.', x: 1200, y: 680, fontSize: 64, anchor: 'middle', duration: 3.5, fill: 'var(--danger-red)'},
        { time: 94.5, type: 'text', id: 'dc-desc3', text: 'Much harder to break!', x: 1200, y: 760, fontSize: 64, anchor: 'middle', duration: 2.5, fill: 'var(--danger-red)'},
        { time: 97.5, type: 'clear' },
        
        // SECTION 5: HOW It's Calculated - The Impedance Path
        { time: 98.5, type: 'text', id: 'title-how', text: "HOW: It's all about the PATH!", x: 800, y: 120, fontSize: 120, anchor: 'middle', weight: 'bold', duration: 3 },
        { time: 102, type: 'text', id: 'grid-label', text: 'Utility Grid', x: 200, y: 250, fontSize: 60, anchor: 'middle', duration: 2},
        { time: 102.5, type: 'text', id: 'grid-z', text: 'Z_grid (low)', x: 200, y: 320, fontSize: 54, anchor: 'middle', fill: 'var(--info-purple)', duration: 2},
        { time: 104.5, type: 'path', id: 'path1', d: 'M 200 400 V 500', strokeWidth: 10, stroke: 'var(--draw-color)', duration: 0.5},
        { time: 105, type: 'rect', id: 'xfmr-box', x: 150, y: 500, width: 100, height: 150, stroke: 'var(--info-purple)', strokeWidth: 8, fill: 'none', duration: 1},
        { time: 105.5, type: 'text', id: 'xfmr-z', text: '+ Z_transformer', x: 200, y: 690, fontSize: 54, anchor: 'middle', fill: 'var(--info-purple)', duration: 2},
        { time: 107.5, type: 'path', id: 'path2', d: 'M 250 575 H 650', strokeWidth: 10, stroke: 'var(--draw-color)', duration: 1},
        { time: 108.5, type: 'text', id: 'fault1', text: 'FAULT', x: 750, y: 585, fontSize: 72, anchor: 'middle', weight: 'bold', duration: 1, class:'flash'},
        { time: 110, type: 'text', id: 'fault1-level', text: 'Fault Level = HIGH', x: 750, y: 700, fontSize: 64, anchor: 'middle', weight: 'bold', fill: 'var(--danger-red)', duration: 2.5},
        { time: 112.5, type: 'text', id: 'fault1-ka', text: '(e.g. 40 kA)', x: 750, y: 770, fontSize: 64, anchor: 'middle', weight: 'bold', fill: 'var(--danger-red)', duration: 2},
        { time: 114.5, type: 'path', id: 'path3', d: 'M 750 575 H 1150', strokeWidth: 10, stroke: 'var(--draw-color)', duration: 1},
        { time: 115.5, type: 'text', id: 'cable-z', text: '+ Z_cable', x: 950, y: 530, fontSize: 54, anchor: 'middle', fill: 'var(--info-purple)', duration: 2},
        { time: 117.5, type: 'text', id: 'fault2', text: 'FAULT', x: 1250, y: 585, fontSize: 72, anchor: 'middle', weight: 'bold', duration: 1, class:'flash'},
        { time: 119, type: 'text', id: 'fault2-level', text: 'Fault Level = LOWER', x: 1250, y: 700, fontSize: 64, anchor: 'middle', weight: 'bold', fill: 'var(--warning-orange)', duration: 3},
        { time: 122, type: 'text', id: 'fault2-ka', text: '(e.g. 25 kA)', x: 1250, y: 770, fontSize: 64, anchor: 'middle', weight: 'bold', fill: 'var(--warning-orange)', duration: 2},
        { time: 124.5, type: 'text', id: 'how-conclusion', text: 'More impedance = lower fault current.', x: 800, y: 860, fontSize: 72, anchor: 'middle', weight: 'bold', fill: 'var(--success-green)', duration: 4},
        { time: 129, type: 'clear' },
        
        // NEW SECTION: Calculation Example
        { time: 130, type: 'text', id: 'calc-title', text: 'Calculation Example', x: 800, y: 100, fontSize: 110, anchor: 'middle', weight: 'bold', duration: 3, fill: 'var(--success-green)'},
        { time: 133.5, type: 'text', id: 'calc-given', text: 'GIVEN: 1500kVA, 415V Transformer with 6% Impedance (%Z)', x: 800, y: 200, fontSize: 60, anchor: 'middle', duration: 4.5},
        { time: 138.5, type: 'text', id: 'calc-step1-title', text: '1. Find Full Load Amps (FLA):', x: 100, y: 320, fontSize: 64, weight: 'bold', duration: 3},
        { time: 141.5, type: 'text', id: 'calc-step1-formula', text: 'FLA = kVA / (1.732 * L-L kV) = 1500 / (1.732 * 0.415) = 2088 A', x: 150, y: 400, fontSize: 54, duration: 6},
        { time: 148, type: 'text', id: 'calc-step2-title', text: '2. Find Fault Multiplier:', x: 100, y: 520, fontSize: 64, weight: 'bold', duration: 3},
        { time: 151, type: 'text', id: 'calc-step2-formula', text: 'Multiplier = 100 / %Z = 100 / 6 = 16.67', x: 150, y: 600, fontSize: 54, duration: 5},
        { time: 156.5, type: 'text', id: 'calc-step3-title', text: '3. Find Short Circuit Current (Isc):', x: 100, y: 720, fontSize: 64, weight: 'bold', duration: 3},
        { time: 159.5, type: 'text', id: 'calc-step3-formula', text: 'Isc = FLA * Multiplier = 2088 A * 16.67 = 34,800 A or 34.8 kA', x: 150, y: 800, fontSize: 54, weight: 'bold', fill: 'var(--danger-red)', duration: 6},
        { time: 166, type: 'clear' },

        // SECTION 7: International Standards
        { time: 167, type: 'text', id: 'title-standards', text: 'Governing Standards', x: 800, y: 150, fontSize: 120, anchor: 'middle', weight: 'bold', duration: 3, fill: 'var(--draw-color)'},
        { time: 170.5, type: 'text', id: 'std1', text: '• IEC 60909:', x: 150, y: 350, fontSize: 72, weight: 'bold', duration: 2},
        { time: 172.5, type: 'text', id: 'std1-sub', text: 'The global standard for', x: 650, y: 320, fontSize: 68, duration: 2.5},
        { time: 175, type: 'text', id: 'std1-sub2', text: 'AC fault calculations.', x: 650, y: 390, fontSize: 68, duration: 2},
        { time: 177.5, type: 'text', id: 'std2', text: '• ANSI/IEEE C37:', x: 150, y: 550, fontSize: 72, weight: 'bold', duration: 2},
        { time: 179.5, type: 'text', id: 'std2-sub', text: 'Predominantly used in', x: 700, y: 520, fontSize: 68, duration: 2.5},
        { time: 182, type: 'text', id: 'std2-sub2', text: 'North America.', x: 700, y: 590, fontSize: 68, duration: 2},
        { time: 184.5, type: 'text', id: 'std3', text: '• IEC 61660:', x: 150, y: 750, fontSize: 72, weight: 'bold', duration: 2},
        { time: 186.5, type: 'text', id: 'std3-sub', text: 'The specific standard for', x: 650, y: 720, fontSize: 68, duration: 2.5},
        { time: 189, type: 'text', id: 'std3-sub2', text: 'DC systems.', x: 650, y: 790, fontSize: 68, duration: 1.5},
        { time: 191, type: 'clear'},

        // Final Promo
        { time: 192, type: 'rect', id: 'promo-bg', x:0, y:0, width: 1600, height: 900, fill: '#1a2a3a', duration: 1},
        { time: 193, type: 'text', id: 'promo-title1', text: 'Design for Safety.', x: 800, y: 250, fontSize: 160, anchor: 'middle', weight: 'bold', duration: 2.5, fill: '#FFFFFF'},
        { time: 195.5, type: 'text', id: 'promo-title2', text: 'Engineer with Confidence.', x: 800, y: 450, fontSize: 140, anchor: 'middle', weight: 'bold', duration: 3, fill: '#facc15'},
        { time: 197.5, type: 'text', id: 'promo-subtitle', text: 'Master complex calculations with professional-grade tools.', x: 800, y: 620, fontSize: 72, anchor: 'middle', duration: 4, fill: '#e5e7eb'},
        { time: 199, type: 'rect', id: 'promo-btn-box', x: 400, y: 720, width: 800, height: 120, fill: '#facc15', stroke: '#fde047', strokeWidth: 5, duration: 1},
        { time: 200, type: 'text', id: 'promo-btn-text', text: 'designcalculators.co.in', x: 800, y: 805, fontSize: 80, anchor: 'middle', weight: 'bold', duration: 2, fill: 'var(--primary-blue)'},
    ];

    function resetAnimation() {
        isPlaying = false;
        timeouts.forEach(t => clearTimeout(t));
        timeouts = [];
        if (animationFrame) cancelAnimationFrame(animationFrame);
        while(svg.firstChild) svg.removeChild(svg.firstChild);
        activeElements = [];
        progressBar.style.width = '0%';
    }

    function updateUI(elapsedSeconds) {
        const percentage = (elapsedSeconds / TOTAL_DURATION) * 100;
        progressBar.style.width = percentage + '%';
    }

    function createElement(item) {
        let el;
        if (item.type === 'text') {
            el = document.createElementNS(svgNS, 'text');
            el.setAttribute('x', item.x);
            el.setAttribute('y', item.y);
            el.setAttribute('font-size', item.fontSize);
            el.setAttribute('fill', item.fill || 'var(--draw-color)');
            if (item.anchor) el.setAttribute('text-anchor', item.anchor);
            if (item.weight) el.setAttribute('font-weight', item.weight);
            if (item.class) el.classList.add(...item.class.split(' '));
            el.setAttribute('font-family', item.font || 'var(--font-main)');
            el.textContent = '';
            el.setAttribute('data-text', item.text);
        } else if (item.type === 'path' || item.type === 'rect') {
            el = document.createElementNS(svgNS, item.type);
            if (item.type === 'path') {
                el.setAttribute('d', item.d);
            } else { // rect
                el.setAttribute('x', item.x);
                el.setAttribute('y', item.y);
                el.setAttribute('width', item.width);
                el.setAttribute('height', item.height);
                el.setAttribute('rx', 15);
            }
            el.setAttribute('stroke', item.stroke || 'var(--draw-color)');
            el.setAttribute('stroke-width', item.strokeWidth || 4);
            el.setAttribute('fill', item.fill || 'none');
        }
        if (el) {
            el.id = item.id;
            el.classList.add('anim-element');
            svg.appendChild(el);
        }
        return el;
    }

    function typeText(el, text, duration) {
        if (!text || text.length === 0) { el.style.opacity = 1; return; }
        let charIndex = 0;
        const chars = text.split('');
        const actualDelay = Math.max(20, (duration * 1000) / chars.length);
        el.style.opacity = 1;

        function addNextChar() {
            if (charIndex < chars.length && isPlaying) {
                el.textContent += chars[charIndex++];
                timeouts.push(setTimeout(addNextChar, actualDelay));
            }
        }
        addNextChar();
    }

    function drawShape(el, duration) {
        el.style.opacity = 1;
        el.style.animationDuration = (duration > 0.6 ? 0.6 : duration) + 's';
        el.classList.add('fade-in');
    }

    function animateItem(item) {
        if (item.type === 'clear') {
            activeElements.forEach(el => {
                if (el && el.parentNode) {
                    el.style.transition = 'opacity 0.4s ease-out';
                    el.style.opacity = 0;
                }
            });
            setTimeout(() => {
                 activeElements.forEach(el => el && el.parentNode && svg.removeChild(el));
                 activeElements = [];
            }, 400);
            return;
        }
        const el = createElement(item);
        if(!el) return;
        activeElements.push(el);
        if(item.type === 'text') {
            typeText(el, el.getAttribute('data-text'), item.duration);
        } else {
            drawShape(el, item.duration);
        }
    }

    function startAnimation() {
        if(isPlaying) return;
        
        resetAnimation();
        replayContainer.classList.remove('visible');
        isPlaying = true;
        const startTime = Date.now();

        timeline.forEach(item => {
            const timeout = setTimeout(() => {
                if(isPlaying) animateItem(item);
            }, item.time * 1000);
            timeouts.push(timeout);
        });

        function updateProgress() {
            if(!isPlaying) return;
            const elapsed = (Date.now() - startTime) / 1000;
            
            if(elapsed >= TOTAL_DURATION) {
                isPlaying = false;
                progressBar.style.width = '100%';
                setTimeout(() => replayContainer.classList.add('visible'), 2000);
                return;
            }
            
            updateUI(elapsed);
            animationFrame = requestAnimationFrame(updateProgress);
        }
        updateProgress();
    }

    function initTutorial() {
        setTimeout(() => {
            splashScreen.classList.add('fade-out');
            setTimeout(() => {
                splashScreen.style.display = 'none';
                startAnimation();
            }, 1000);
        }, 2500);
    }

    replayBtn.addEventListener('click', startAnimation);
    window.addEventListener('load', initTutorial);
    window.addEventListener('beforeunload', resetAnimation);
</script>
</body>
</html>



